<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 11 February 2007), see www.w3.org" />
  <script type="text/javascript" src="http://cdn.buglabs.net/swarm/swarm-v0.4.0.js"></script>
</script>
  <link rel="stylesheet" href=
  "http://twitter.github.com/bootstrap/1.3.0/bootstrap.min.css" type="text/css" />

  <title></title>
</head>

<body onload="loadValues()">
  <div class="container">
    <form name="swarmfields" id="swarmfields">
      <fieldset>
        <legend>BUGswarm Console</legend>

        <div class="clearfix">
          <label for="apikey">Consumer API Key</label>

          <div class="input">
            <input class="xxlarge" id="apikey" name="apikey" size="14" type="text" />
          </div>
        </div><!-- /clearfix -->

        <div class="clearfix">
          <label for="swarmID">Swarm ID</label>

          <div class="input">
            <input class="xxlarge" id="swarmID" name="swarmID" size="14" type="text" />
          </div>
        </div><!-- /clearfix -->

        <div class="clearfix">
          <label for="muc">Global Messages</label>

          <div class="input">
            <textarea class="xxlarge" name="muc" id="muc" rows="15" readonly="readonly">
</textarea>
          </div>
        </div><!-- /clearfix -->

        <div class="actions">
          <input type="button" class="btn primary" value="Join Swarm" onclick=
          "javascript: joinSwarm()" />&nbsp;<button type="reset" class=
          "btn">Cancel</button>
        </div>
      </fieldset>
    </form><script language="javascript" type="text/javascript">
//<![CDATA[
   function supports_html5_storage() {
        try {
    return 'localStorage' in window && window['localStorage'] !== null;
    } catch (e) {
    return false;
    }
    }

    function joinSwarm(){
            if (supports_html5_storage()){
               localStorage.setItem("bugswarm_apikey", document.swarmfields.apikey.value);
               localStorage.setItem("bugswarm_swarmID", document.swarmfields.swarmID.value);
            }
            SWARM.join({apikey: document.swarmfields.apikey.value +'', 
                        swarms: [document.swarmfields.swarmID.value +''],
                        callback: function(message) {
                            document.swarmfields.muc.value+=JSON.stringify(message, null, '\t');
                            document.swarmfields.muc.scrollTop = document.swarmfields.muc.scrollHeight;
                        }
            });
        }
       
    
        function loadValues(){
		if (supports_html5_storage()){
			if (typeof(localStorage["bugswarm_apikey"])!="undefined"){
	        		document.swarmfields.apikey.value = localStorage["bugswarm_apikey"];
			}
			if (typeof(localStorage["bugswarm_swarmID"])!="undefined"){
	        		document.swarmfields.swarmID.value = localStorage["bugswarm_swarmID"];
			}
        	}
	}
    //]]>
    </script>
  </div>
</body>
</html>

